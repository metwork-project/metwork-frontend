<!-- route show -->

<div class="card">
  <div class="card-body">
      {{alert-generic
        alertType="danger"
        message=errorSaveMessage}}
    <div class="d-flex">
      <h3  class="mr-auto">
        {{model.name}}
        {{status-badge model=model class="d-inline"}}
      </h3>
      <div class="m-1">
        {{#if model.notObsolete}}
          {{#bs-button type=mainBtnInfo.btnType onClick=(action mainBtnInfo.action) class="m-1"}}
            {{mainBtnInfo.label}}
          {{/bs-button}}
        {{/if}}
      </div>
    </div>
      <div>
        <form>
          <div class="container"><div class="row">
              <div class="form-group col-lg-4">
                <label>Name</label>
                {{input value=model.name model=model class='form-control'}}
                <label>Description</label>
                {{textarea value=model.description model=model class='form-control' rows='3'}}

                <div>
                  {{#if model.isEditing}}
                    {{bs-button type="primary" class="m-1"
                      defaultText="Load SMARTS"
                      onClick=(action (mut smartsReactionModal) true) }}
                  {{else}}
                    <p><b>Number of reactants :</b> {{model.reactants_number}} </p>
                  {{/if}}
                </div>
              </div>
              <div class="form-group col-lg-8">
                {{{image}}}
                {{#if model.isEditing}}
                  {{chemical-editor
                    model=model
                    chemType='reaction'
                    skecthId='sketcher-reaction'
                    evaluateAction=(action 'saveReaction')
                    saveModelComponent=saveReactionComponent
                    smartsModal=smartsReactionModal
                    sketcherReady=sketcherReady}}
                {{else}}
                  {{chemical-display
                    canvasId='canvas-reaction'
                    model=model
                    chemType='reaction'
                  }}
                {{/if}}
              </div>
            </div>
          </div>
        </form>
      </div>
  <!-- Test Reaction -->
      {{#if model.isAtLeastValid}}
        <h4 class="mr-auto">
            Test reaction
        </h4>
        <form>
          <div class="container">
            <div class="row">
              <div class="form-group col-md-6">
                <h5>Reactant(s)</h5>
                {{#if products}}
                  {{#each reactantsJSON as |reactant index|}}
                    {{chemical-display
                      canvasId='canvas-reactant-'
                      index=index
                      dataJSON=reactant
                      chemType='molecule'
                    }}
                  {{/each}}
                  {{bs-button type="primary" class="m-1"
                    defaultText="New test"
                    onClick=(action (mut products) false) }}
                {{/if}}
                {{!-- {{else}} --}}
                <div class={{if products 'd-none'}} >
                  {{chemical-editor
                    visible=(eq products false)
                    model=reactants
                    chemType='molecule'
                    skecthId='sketcher-reactants'
                    evaluateAction=(action 'runReaction')
                    saveModelComponent=saveReactantsComponent
                    smartsModal=smartsReactantsModal
                    sketcherReady=sketcherReady}}

                    {{bs-button type="primary" class="m-1"
                      defaultText="Load SMILES"
                      onClick=(action (mut smartsReactantsModal) true) }}
                </div>

              </div>
              <div class="form-group col-md-6">
                {{#if products}}
                  <h5>Products</h5>
                  {{#each products as |product index|}}
                    {{chemical-display
                      canvasId='canvas-product-'
                      index=index
                      dataJSON=product
                      chemType='molecule'
                    }}
                  {{/each}}
                {{else}}
                  <button type="button"
                      class="btn reaction-reactants m-2 btn-primary"
                      onClick={{action 'runReaction' false}}>
                        Run reaction
                  </button>
                {{/if}}
                {{alert-generic
                  alertType="danger"
                  message=errorReactionMessage}}
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-center">

          </div>
        </form>
      {{/if}}
  </div>
  {{#if model.is_reactor}}
    <div class="card-footer">
      <img src="/assets/images/powered_by_chemaxon_GOLD_M.png" class="mx-auto d-block" height=40 />
    </div>
  {{/if}}
</div>
